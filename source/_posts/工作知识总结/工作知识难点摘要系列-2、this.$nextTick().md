---
title: 二、this.$nextTick()
tags: 工作知识总结
categories: 热爱我的工作
comments: true
---

# 二、工作知识难点摘要之this.$nextTick()
## 1、this.$nextTick()的使用
### 1.1、为什么要有this.$nextTick()
<p>&emsp;&emsp;一句话，用我的理解，this.$nextTick就是为了应对DOM的，因为在vue中，DOM的更新是异步的。Vue的响应式并不是只数据发生变化之后，DOM就立刻发生变化，而是按照一定的策略进行DOM的更新。这样的好处是可以避免一些对DOM不必要的操作，提高渲染性能。</p>

<p>&emsp;&emsp;其实这是和JS当中的事件循环是息息相关的，就是Vue不可能对每一个数据变化都做一次渲染，它会把这些变化先放在一个异步的队列当中，同时它还会对这个队列里面的操作进行去重，比如你修改了这个数据三次，它只会保留最后一次。这些变化是都可以通过队列的形式保存起来，那现在的问题就来到了，那vue是在事件循环的哪个时机来对DOM进行修改呢？</p>

<p>&emsp;&emsp;Vue有两种选择，一个是在本次事件循环的最后进行一次DOM更新，另一种是把DOM更新放在下一轮的事件循环当中。这时，尤雨溪拍了拍胸脯说：“这两种方法，我都有!”  但是因为本轮事件循环最后执行会比放在下一轮事件循环要快很多，所以Vue优先选择第一种，只有当环境不支持的时候才触发第二种机制。</p>

<p>&emsp;&emsp;虽然性能上提高了很多，但这个时候问题就出现了，我们都知道在一轮事件循环中，<span style="color: red">同步执行栈中代码执行完成之后，才会执行异步队列当中的内容，</span> 那我们获取DOM的操作是一个同步的呀！！那岂不是虽然我已经把数据改掉了，但是它的更新异步的，而在获取的时候，它还没有来得及改。</p>

<p>&emsp;&emsp;总结:nextTick当中的操作不会立即执行，而是等数据更新、DOM更新完成之后再执行，这样我们拿到的肯定就是最新的了。再准确一点来讲就是this.$nextTick()方法将回调延迟到下次DOM更新循环之后执行。</p>

</p>&emsp;&emsp;<strong>使用场景</strong>：1、created中获取DOM的操作需要使用它，因为created钩子还未创建DOM，此时无法访问DOM，必须要延迟；
2、当我们把DOM的某些数据改掉时，DOM还未立即更新，但是我们想通过DOM拿到最新的结果，比如用this.$ref访问组件或者标签，得用它。</p>

[B站讲解视频](https://www.bilibili.com/video/BV1vK4y1U7sq/?spm_id_from=333.788.recommend_more_video.4&vd_source=bc93e908334fea5384c4d1d3b8e66bbc)